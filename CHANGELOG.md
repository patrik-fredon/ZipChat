# Changelog

All notable changes to this project will be documented in this file.

The format is based on [Keep a Changelog](https://keepachangelog.com/en/1.0.0/),
and this project adheres to [Semantic Versioning](https://semver.org/spec/v2.0.0.html).

## [Unreleased]

### Added

- Initial project setup
- Basic project structure
- Documentation structure
- User model implementation
- Key model implementation
- Database layer documentation
- Security documentation
- Monitoring documentation
- Infrastructure documentation
- Backend documentation
- Frontend documentation
- Architecture documentation
- CHANGELOG.md for tracking changes
- Updated backend documentation with latest structure
- Encryption service implementation with:
  - Message encryption using AES-256-GCM
  - Message decryption with authentication
  - Key rotation functionality
  - Input validation using Zod
- Message controller implementation with:
  - Message encryption endpoint
  - Message decryption endpoint
  - Key rotation endpoint
  - New message endpoints:
    - Send message with attachments
    - Typing indicator
    - Message drafts
- Message routes implementation with:
  - Authentication middleware
  - RESTful endpoints for message operations
  - File upload middleware
- Message model implementation with:
  - Secure message storage
  - Message expiration
  - Read status tracking
  - Pagination support
  - Message retrieval methods
  - Mongoose schema with proper indexing
  - Message status tracking (sent, delivered, read)
  - Efficient conversation queries
  - Attachment support
  - Draft storage
- Message service implementation with:
  - Secure message sending
  - Message retrieval with decryption
  - Read status management
  - Real-time notifications
  - User verification
  - Attachment handling
  - Draft management
- WebSocket service implementation with:
  - Secure WebSocket connections
  - JWT authentication
  - Real-time message delivery
  - Message status updates
  - User online status
  - Connection health monitoring
  - Automatic reconnection
  - Typing indicator notifications
- Frontend message components:
  - MessageList component for displaying messages
  - MessageItem component for individual messages
  - MessageComposer component for sending messages
  - Czech localization for dates and messages
  - Real-time message updates
  - Message expiration handling
  - Read status tracking
  - Chat window component with:
    - Real-time message delivery
    - Message status indicators
    - User online status
    - Infinite scroll for message history
    - Error handling and loading states
  - Message grouping by time and sender
  - Message status indicators (sent, delivered, read)
  - Responsive design with Tailwind CSS
  - Accessibility improvements
  - MessageList component with:
    - Message grouping by time and sender
    - Infinite scroll for message history
    - Automatic message read detection
    - Loading state handling
    - Czech date localization
  - MessageItem component with:
    - Message status indicators (sent, delivered, read)
    - Timestamp display in Czech format
    - Different styling for own/other messages
    - Responsive design with Tailwind CSS
  - MessageComposer component with:
    - Auto-resizing textarea
    - Typing indicators
    - Message validation
    - Keyboard shortcuts
    - Emoji support
    - File attachment preview
    - Message draft saving
    - Accessibility improvements
  - EmojiPicker component with:
    - Emoji search
    - Grid layout
    - Keyboard navigation
    - Accessibility improvements
  - FilePreview component with:
    - File type icons
    - File size formatting
    - Remove functionality
    - Responsive design
  - Custom hooks:
    - useLocalStorage for draft saving
    - useTypingIndicator for typing status
  - Utils:
    - Emoji list for picker
    - File type icons
    - File size formatting
- Database integration:
  - PostgreSQL connection setup
  - Message storage implementation
  - Key storage implementation
  - User storage implementation
  - MongoDB integration for messages
  - Efficient indexes for queries
  - Attachment storage
  - Draft storage
- Automated cleanup:
  - Cron job for expired messages
  - Hourly cleanup schedule
  - Logging of cleanup operations
  - Attachment cleanup
- Real-time communication:
  - WebSocket service implementation
  - Real-time message updates
  - Automatic reconnection
  - Message handler management
  - Ping/pong health checks
  - Client connection management
  - Typing indicator notifications
- Frontend chat components implementation:
  - ChatWindow component with:
    - Real-time message updates
    - User status indicators
    - Message history with infinite scroll
    - Error handling and loading states
    - Responsive design
  - MessageList component with:
    - Message grouping by time and sender
    - Efficient message rendering
    - Empty state handling
    - Scroll management
  - Message component with:
    - Status indicators (sent, delivered, read)
    - Timestamp display
    - Message bubble styling
    - Accessibility improvements
  - Czech localization for all UI elements
  - Tailwind CSS styling for consistent design
  - MessageComposer component with:
    - Auto-resizing textarea
    - Typing indicators
    - Message validation
    - Keyboard shortcuts
    - Emoji support
    - File attachment preview
    - Message draft saving
    - Accessibility improvements
  - Common components:
    - EmojiPicker for emoji selection
    - FilePreview for attachment preview
  - Custom hooks:
    - useLocalStorage for draft saving
    - useTypingIndicator for typing status
  - Utils:
    - Emoji list for picker
    - File type icons
    - File size formatting
- Backend services:
  - MessageService with:
    - Secure message sending
    - Message retrieval with decryption
    - Read status management
    - Real-time notifications
    - User verification
    - Attachment handling
    - Draft management
  - WebSocketService with:
    - Secure WebSocket connections
    - JWT authentication
    - Real-time message delivery
    - Message status updates
    - User online status
    - Connection health monitoring
    - Automatic reconnection
    - Typing indicator notifications
  - File upload middleware with:
    - Secure file storage
    - File type validation
    - File size limits
    - Unique filename generation
- Frontend testy pro komponenty:
  - MessageComposer testy:
    - Testování vykreslení komponenty
    - Testování odeslání zprávy
    - Testování příloh
    - Testování emoji
    - Testování indikátoru psaní
    - Testování konceptů
    - Testování chyb
  - MessageList testy:
    - Testování vykreslení zpráv
    - Testování stavu načítání
    - Testování prázdného stavu
    - Testování seskupování zpráv podle data
    - Testování načítání starších zpráv
    - Testování označení zprávy jako přečtené
    - Testování výběru zprávy
    - Testování mazání zprávy
    - Testování stavových indikátorů
    - Testování příloh
  - MessageItem testy:
    - Testování vykreslení obsahu
    - Testování časových razítek
    - Testování stavových indikátorů
    - Testování stylování
    - Testování přístupnosti
  - EmojiPicker testy:
    - Testování vykreslení emoji
    - Testování vyhledávání emoji
    - Testování výběru emoji
    - Testování prázdného vyhledávání
    - Testování tooltipů
  - FileUploader testy:
    - Testování vykreslení komponenty
    - Testování výběru souborů
    - Testování drag & drop
    - Testování validace typů souborů
    - Testování validace velikosti souborů
    - Testování chybových hlášek
- UserService implementation with:
  - User profile management
  - User data validation
  - Secure password storage
  - User role management
  - Two-factor authentication support
  - Email verification
  - User activity tracking
- UserRepository implementation with:
  - Database operations for users
  - Prepared statements for security
  - Efficient querying
  - Proper error handling
  - Data mapping
- User interface and model with:
  - Type-safe user data structure
  - Role-based access control
  - User profile fields
  - Security-related fields
  - Activity tracking fields
- AuthenticationService implementation with:
  - User registration with password hashing
  - Secure login with JWT tokens
  - Token verification
  - Password change functionality
  - Password reset functionality
  - Secure password storage
  - Role-based access control
  - Two-factor authentication support
  - Email verification
  - User activity tracking
  - Secure logging
  - Error handling
  - Input validation
- NotificationService implementation with:
  - Real-time notifications via WebSocket
  - Notification types (message, friend request, system, security)
  - Notification management (create, read, delete)
  - Unread notifications count
  - Pagination support
  - Notification grouping
  - Notification persistence
  - Error handling
  - Secure logging
- NotificationRepository implementation with:
  - Database operations for notifications
  - Efficient querying with pagination
  - Prepared statements for security
  - Proper error handling
  - Data mapping
  - Notification cleanup
- Notification interface and model with:
  - Type-safe notification structure
  - Multiple notification types
  - Read status tracking
  - Timestamp tracking
  - Custom data support

### Changed

- Refactored backend documentation to be more comprehensive
- Updated project structure documentation
- Improved code organization in backend
- Enhanced security measures in encryption service
- Improved error handling in controllers
- Optimized message storage structure
- Enhanced user experience with loading states
- Improved error handling in frontend components
- Migrated message storage to MongoDB for better scalability
- Enhanced WebSocket implementation with proper connection management
- Optimized database queries:
  - Added prepared statements
  - Improved query performance
  - Added proper indexing
  - Implemented efficient message retrieval
- Enhanced security:
  - Implemented proper password hashing
  - Added input validation
  - Improved error handling
  - Added WebSocket authentication
  - Added file upload validation
  - Enhanced attachment security
- Improved frontend components:
  - Added real-time updates
  - Enhanced error handling
  - Improved loading states
  - Added automatic reconnection
  - Added message delivery status
  - Enhanced message grouping
  - Improved accessibility
  - Optimized performance
- Enhanced frontend components:
  - Improved message composer UX:
    - Better textarea resizing
    - Smoother animations
    - Enhanced keyboard navigation
    - Improved mobile experience
  - Enhanced file handling:
    - Better file preview
    - Improved file type detection
    - Enhanced file size formatting
  - Improved emoji picker:
    - Better emoji organization
    - Enhanced search functionality
    - Improved accessibility
  - Enhanced typing indicators:
    - Better timing
    - Improved status updates
    - Enhanced real-time feedback
- Enhanced backend services:
  - Improved message handling
  - Enhanced WebSocket communication
  - Better error handling
  - Improved security measures
  - Enhanced file upload handling
  - Better draft management
  - Improved typing indicator handling
- Vylepšena testovatelnost frontend komponent
- Optimalizováno pokrytí testy
- Vylepšena dokumentace testů
- Zlepšena organizace testovacích souborů
- Přidána konzistence v testovacích datech
- Improved user management:
  - Enhanced user data validation
  - Better error handling
  - Improved security measures
  - Enhanced role management
  - Better database operations
  - Improved logging
- Enhanced authentication:
  - Improved password security
  - Better token management
  - Enhanced error handling
  - Improved logging
  - Better input validation
  - Enhanced role-based access control
  - Improved two-factor authentication
  - Better email verification
  - Enhanced user activity tracking
- Enhanced notification system:
  - Improved real-time delivery
  - Better notification grouping
  - Enhanced notification persistence
  - Improved notification cleanup
  - Better error handling
  - Enhanced security measures
  - Improved logging
  - Better WebSocket integration
  - Enhanced notification types
  - Improved notification management

### Deprecated

- N/A

### Removed

- PostgreSQL message storage in favor of MongoDB

### Fixed

- N/A

### Security

- Implemented secure key rotation
- Added message authentication
- Enhanced input validation
- Added authentication middleware for message routes
- Added message expiration
- Implemented secure message storage
- Added client-side validation for message content
- Implemented secure message decryption flow
- Added password hashing with bcrypt
- Implemented secure key storage
- Added rate limiting for API endpoints
- Enhanced database security with prepared statements
- Added automated cleanup of sensitive data
- Added WebSocket authentication with JWT
- Implemented secure WebSocket communication
- Added connection health monitoring
- Implemented proper WebSocket connection cleanup
- Enhanced frontend security:
  - Added input sanitization
  - Improved error message handling
  - Enhanced WebSocket connection security
  - Added proper error boundaries
  - Implemented secure file upload handling
  - Added message content validation
  - Enhanced XSS protection
  - Added file type validation
  - Implemented secure file preview
  - Added emoji sanitization
  - Enhanced local storage security
  - Added typing indicator rate limiting
  - Added file size limits
  - Implemented secure file storage
  - Added file type restrictions
  - Enhanced attachment security
- Enhanced backend security:
  - Improved JWT validation
  - Enhanced WebSocket authentication
  - Better file upload security
  - Improved message encryption
  - Enhanced draft security
  - Better typing indicator security
- Přidána validace vstupů v testech
- Vylepšena bezpečnost testovacích dat
- Přidána izolace testovacích případů
- Vylepšena bezpečnost testovacích souborů
- Enhanced user security:
  - Added password validation
  - Implemented secure password storage
  - Added email validation
  - Enhanced role-based access control
  - Added two-factor authentication support
  - Improved user data validation
  - Enhanced database security
  - Added proper error handling
  - Implemented secure logging
- Enhanced authentication security:
  - Added secure password hashing
  - Implemented JWT token security
  - Added token expiration
  - Enhanced password reset security
  - Added rate limiting for authentication attempts
  - Implemented secure session management
  - Added input sanitization
  - Enhanced error handling
  - Improved logging
  - Added role-based access control
  - Implemented two-factor authentication
  - Added email verification
  - Enhanced user activity tracking
- Enhanced notification security:
  - Added notification validation
  - Implemented secure notification storage
  - Added notification expiration
  - Enhanced notification cleanup
  - Added rate limiting for notifications
  - Improved notification access control
  - Enhanced WebSocket security
  - Added input sanitization
  - Improved error handling
  - Enhanced logging
  - Added proper data validation
